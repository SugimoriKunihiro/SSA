<!DOCTYPE html>
<html>
  <head>
    <title>ARIEL</title>
    <base target="_top">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css"    
      integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" 
      integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" 
      integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" 
      integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>

    <style>
      html, body, #app {
        margin: 0;
        height: 100%;
        overflow: hidden;
      }

      .fullscreen-appsheet {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        z-index: 1;
      }

      .fullscreen-appsheet iframe {
        width: 100%;
        height: 100%;
        border: none;
      }
      
      /* AppSheetãƒ˜ãƒ«ãƒ‘ãƒ¼ã®ã‚¹ã‚¿ã‚¤ãƒ« */
      .appsheet-helper {
        opacity: 0.95;
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        transition: opacity 0.3s ease;
      }
      
      .appsheet-helper:hover {
        opacity: 1;
      }

      #nav-hover-zone {
        position: fixed;
        top: 0;
        left: 0;
        height: 30px;
        width: 100vw;
        background: transparent;
        z-index: 100;
        pointer-events: auto;
      }

      #nav-hover-bar {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 40px;
        background-color: #343a40;
        color: white;
        z-index: 101;
        transform: translateY(-100%);
        transition: transform 0.4s ease-in-out;
        pointer-events: auto;
      }

      #nav-hover-bar.active {
        transform: translateY(0%);
      }
    </style>
  </head>

  <body class="bg-dark">
  <div id="app"><!--appã“ã“ã‹ã‚‰-->

  <!-- iframeå…¨ç”»é¢ -->
  <div class="fullscreen-appsheet" id="appsheet-container-99999" v-show="showContents[0] === '99999'">
    <iframe
      src="https://www.appsheet.com/start/b3cc011c-f2d9-4021-b16f-2efdd921a42b"
      ref="fullscreenFrame"
      :style="{
        width: '100%',
        height: '100%',
        border: 'none',
        pointerEvents: showNav ? 'none' : 'auto'
      }"
      scrolling="no"
      allowfullscreen
      allow="clipboard-read; clipboard-write;"
      @load="handleIframeLoad"
      @error="iframeError = true">
    </iframe>
    
    <!-- AppSheetå°‚ç”¨ã®ãƒ˜ãƒ«ãƒ—ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ -->
    <div v-if="!alreadyOpened" 
         class="appsheet-helper alert alert-info m-3 position-absolute" 
         style="top: 0; left: 0; right: 0; max-width: 600px; margin: 0 auto; z-index: 10;">
      <button type="button" class="close" @click="alreadyOpened = true">&times;</button>
      <h5>AppSheetã‚¢ãƒ—ãƒªã«ã¤ã„ã¦</h5>
      <p>è¡¨ç¤ºã«å•é¡ŒãŒã‚ã‚‹å ´åˆã¯ã€ä¸‹è¨˜ã®ã€Œæ–°ã—ã„ã‚¿ãƒ–ã§é–‹ãã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚ã¾ãŸã¯X-frame headerã‚’ç„¡åŠ¹åŒ–ã™ã‚‹ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã«å°å…¥ã—ã¦ãã ã•ã„</p>
      <button @click="openAppsheetInNewTab" class="btn btn-primary btn-sm">
        æ–°ã—ã„ã‚¿ãƒ–ã§é–‹ã
      </button>
    </div>
  </div>

  <!-- ã‚¨ãƒ©ãƒ¼æ™‚ã®å¼·åŒ–ã•ã‚ŒãŸAppSheetãƒªã‚«ãƒãƒªãƒ¼UI -->
  <div v-if="iframeError" class="d-flex flex-column align-items-center my-4 p-3 bg-light rounded">
    <div class="alert alert-danger mb-3 w-100" role="alert">
      <h4 class="alert-heading">
        <span class="mr-2">âš ï¸</span> 
        AppSheetã‚¢ãƒ—ãƒªã®è¡¨ç¤ºã«å•é¡ŒãŒç™ºç”Ÿã—ã¦ã„ã¾ã™
      </h4>
      <p>ã‚µãƒ¼ãƒãƒ¼ã¸ã®æ¥ç¶šãŒæ‹’å¦ã•ã‚Œã¾ã—ãŸã€‚ã“ã‚Œã«ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªåŸå› ãŒè€ƒãˆã‚‰ã‚Œã¾ã™ï¼š</p>
      <ul>
        <li>ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šã®å•é¡Œï¼ˆä¼æ¥­ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®åˆ¶é™ãªã©ï¼‰</li>
        <li>AppSheetã‚µãƒ¼ãƒ“ã‚¹ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã®å•é¡Œ</li>
        <li>ãƒ–ãƒ©ã‚¦ã‚¶ã®èªè¨¼æƒ…å ±ã‚„Cookieã®å•é¡Œ</li>
      </ul>
    </div>
    
    <div class="d-flex flex-column flex-md-row mb-3 w-100 justify-content-center">
      <button @click="openAppsheetFallback" class="btn btn-primary btn-lg m-2">
        <span class="mr-2">ğŸ”—</span> 
        AppSheetã‚’æ–°ã—ã„ã‚¿ãƒ–ã§é–‹ã
      </button>
      
      <button @click="troubleshootAppSheet" class="btn btn-outline-secondary btn-lg m-2">
        <span class="mr-2">ğŸ”§</span>
        ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
      </button>
    </div>
    
    <small class="text-muted mb-2">â€» ãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ãƒ–ãƒ­ãƒƒã‚¯ã‚’è¨±å¯ã—ã¦ãã ã•ã„</small>
    
    <div class="card w-100 mt-3">
      <div class="card-header bg-info text-white">
        ã•ã‚‰ã«è©³ã—ã„è§£æ±ºæ–¹æ³•
      </div>
      <div class="card-body">
        <ol>
          <li>Google ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«ç›´æ¥ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„</li>
          <li>ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆãƒ¢ãƒ¼ãƒ‰ã‚„åˆ¥ã®ãƒ–ãƒ©ã‚¦ã‚¶ã§è©¦ã—ã¦ã¿ã¦ãã ã•ã„</li>
          <li>ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¨Cookieã‚’ã‚¯ãƒªã‚¢ã—ã¦ã‹ã‚‰å†è©¦è¡Œã—ã¦ãã ã•ã„</li>
          <li>ä¼æ¥­ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å ´åˆã¯ã€å€‹äººå›ç·šã§è©¦ã—ã¦ã¿ã¦ãã ã•ã„</li>
          <li>ç›´æ¥ <a href="https://www.appsheet.com" target="_blank">AppSheet</a> ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ãƒ­ã‚°ã‚¤ãƒ³ã—ãŸå¾Œã€ã“ã®ãƒãƒ¼ã‚¿ãƒ«ã«æˆ»ã£ã¦ãã¦ãã ã•ã„</li>
        </ol>
      </div>
    </div>
    
    <button @click="resetAppSheetError" class="btn btn-link mt-3">
      ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºã‚’é–‰ã˜ã‚‹
    </button>
  </div>

  <!-- ãƒ›ãƒãƒ¼ã‚¾ãƒ¼ãƒ³ã¨ãƒŠãƒ“ -->
    <div id="nav-hover-zone" v-show="showContents[0] !== '99999'" @mouseenter="showNav = true" @mouseleave="showNav = false"></div>
    <nav 
      id="nav-hover-bar"
      class="navbar navbar-expand-lg navbar-dark bg-secondary px-3"
      :class="{ active: showNav }"
      @mouseenter="showNav = true"
      @mouseleave="showNav = false">
      <h3 class="navbar-brand" @click="toggle('99999')">ARIEL</h3>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown"
          aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
      
      <!--ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ãƒªã‚¹ãƒˆã“ã“ã‹ã‚‰-->
      <div class="collapse navbar-collapse" id="navbarNavDropdown">
        <ul class="navbar-nav">
 
         <!--ã‚«ãƒ†ã‚´ãƒªæ¯ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³(ãƒªãƒ³ã‚¯)ã“ã“ã‹ã‚‰-->
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" role="button" data-toggle="dropdown">Knowledge</a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
              <a v-for="knowledge in knowledges" :key="knowledge.id" class="dropdown-item" v-bind:href="knowledge.url" target="_blank">{{knowledge.name}}</a>
            </div>
          </li>
          <!--ã‚«ãƒ†ã‚´ãƒªæ¯ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³(ãƒªãƒ³ã‚¯)ã“ã“ã¾ã§-->
         
        <!--åŸ‹ã‚è¾¼ã¿ç”¨ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ãƒªã‚¹ãƒˆã“ã“ã‹ã‚‰ 
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" role="button" data-toggle="dropdown">Knowledge</a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
              <a class="dropdown-item" @click="toggle('99999')" >MAIN APPSHEET</a>
              <a v-for="sheet in sheets" :key="sheet.id" class="dropdown-item" @click="toggle(sheet.id)" >{{sheet.name}}</a>
            </div>
          </li>
          ã“ã“ã¾ã§-->
          
          <!--ã‚«ãƒ†ã‚´ãƒªæ¯ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³(ãƒªãƒ³ã‚¯)ã“ã“ã‹ã‚‰-->
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" role="button" data-toggle="dropdown">Learning</a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
              <a v-for="learning in learnings" :key="learning.id" class="dropdown-item" v-bind:href="learning.url" target="_blank">{{learning.name}}</a>
            </div>
          </li>
          <!--ã‚«ãƒ†ã‚´ãƒªæ¯ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³(ãƒªãƒ³ã‚¯)ã“ã“ã¾ã§-->
      
          <!--ã‚«ãƒ†ã‚´ãƒªæ¯ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³(ãƒªãƒ³ã‚¯)ã“ã“ã‹ã‚‰-->
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" role="button" data-toggle="dropdown">Drive</a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
              <a v-for="drive in drives" :key="drive.id" class="dropdown-item" v-bind:href="drive.url" target="_blank">{{drive.name}}</a>
            </div>
          </li>
          <!--ã‚«ãƒ†ã‚´ãƒªæ¯ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³(ãƒªãƒ³ã‚¯)ã“ã“ã¾ã§-->

          <!--ã‚«ãƒ†ã‚´ãƒªæ¯ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³(ãƒªãƒ³ã‚¯)ã“ã“ã‹ã‚‰-->
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" role="button" data-toggle="dropdown">Google</a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
              <a v-for="gsuite in gsuites" :key="gsuite.id" class="dropdown-item" v-bind:href="gsuite.url" target="_blank">{{gsuite.name}}</a>
            </div>
          </li>
          <!--ã‚«ãƒ†ã‚´ãƒªæ¯ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³(ãƒªãƒ³ã‚¯)ã“ã“ã¾ã§-->

          <!--ã‚«ãƒ†ã‚´ãƒªæ¯ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³(ãƒªãƒ³ã‚¯)ã“ã“ã‹ã‚‰-->
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" role="button" data-toggle="dropdown">App</a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
              <a v-for="tool in tools" :key="tool.id" class="dropdown-item" v-bind:href="tool.url" target="_blank">{{tool.name}}</a>
            </div>
          </li>
          <!--ã‚«ãƒ†ã‚´ãƒªæ¯ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³(ãƒªãƒ³ã‚¯)ã“ã“ã¾ã§-->

          <!--ã‚«ãƒ†ã‚´ãƒªæ¯ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³(ãƒªãƒ³ã‚¯)ã“ã“ã‹ã‚‰-->
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" role="button" data-toggle="dropdown">IT</a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
              <a v-for="it in its" :key="it.id" class="dropdown-item" v-bind:href="it.url" target="_blank">{{it.name}}</a>
            </div>
          </li>
          <!--ã‚«ãƒ†ã‚´ãƒªæ¯ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³(ãƒªãƒ³ã‚¯)ã“ã“ã¾ã§-->

          <!--ã‚«ãƒ†ã‚´ãƒªæ¯ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³(ãƒªãƒ³ã‚¯)ã“ã“ã‹ã‚‰-->
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" role="button" data-toggle="dropdown">Media</a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
              <a v-for="tv in tvs" :key="tv.id" class="dropdown-item" v-bind:href="tv.url" target="_blank">{{tv.name}}</a>
            </div>
          </li>
          <!--ã‚«ãƒ†ã‚´ãƒªæ¯ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³(ãƒªãƒ³ã‚¯)ã“ã“ã¾ã§-->

          <!--ã‚«ãƒ†ã‚´ãƒªæ¯ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³(ãƒªãƒ³ã‚¯)ã“ã“ã‹ã‚‰-->
           <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" role="button" data-toggle="dropdown">SNS/Private</a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
              <a v-for="prv in prvs" :key="prv.id" class="dropdown-item" v-bind:href="prv.url" target="_blank">{{prv.name}}</a>
            </div>
          </li>
          <!--ã‚«ãƒ†ã‚´ãƒªæ¯ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³(ãƒªãƒ³ã‚¯)ã“ã“ã¾ã§-->
        </ul>
      </div>
      <!--ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ãƒªã‚¹ãƒˆã“ã“ã¾ã§-->
    </nav>
  <!--ãƒŠãƒ“ãƒãƒ¼ã“ã“ã¾ã§-->
  </br>
     
     <!--ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã«å¯¾ã™ã‚‹ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã“ã“ã‹ã‚‰-->
      <div id="sub">
        
        <!--ã‚«ãƒ†ã‚´ãƒªå†…ãƒ•ãƒ¬ãƒ¼ãƒ ã“ã“ã‹ã‚‰
        <div v-for="sheet in sheets" :key="sheet.id">
         <div v-if="showContents==sheet.id">
          <div class="embed-responsive embed-responsive-21by9 bg-light"> 
            <iframe class="embed-responsive-item allowfullscreen" v-bind:src="sheet.url"></iframe>
          </div>
         </div>
        </div>
        ã‚«ãƒ†ã‚´ãƒªå†…ãƒ•ãƒ¬ãƒ¼ãƒ ã“ã“ã¾ã§-->

      </div>
      <!--ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã«å¯¾ã™ã‚‹ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã“ã“ã¾ã§-->
    
  </div>
  <!--appã“ã“ã¾ã§-->
  <!--ã“ã“ã‹ã‚‰Vueã®è¨­å®š-->
</body>
<script src="https://cdn.jsdelivr.net/npm/vue@2.6.12"></script>
<script>
var app = new Vue({
  el:"#app",
  data:{
     knowledges:[
      {id:"0001",name:"Chat-GPT",url:"https://chatgpt.com/"},
      {id:"0002",name:"Flier",url:"https://www.flierinc.com/"},
      {id:"0003",name:"Googleãƒ‹ãƒ¥ãƒ¼ã‚¹",url:"https://news.google.com/"},
      {id:"0004",name:"çµŒæ¸ˆãƒ¬ãƒãƒ¼ãƒˆ",url:"http://www3.keizaireport.com/"},
      {id:"0005",name:"æœæ—¥æ–°è",url:"https://www.asahi.com/?iref=pc_gnavi"},
      {id:"0006",name:"NHKãƒ‹ãƒ¥ãƒ¼ã‚¹",url:"https://www3.nhk.or.jp/news/"},
      {id:"0007",name:"ãƒãƒ•ãƒã‚¹",url:"https://www.huffingtonpost.jp/"},
      {id:"0008",name:"æ±æ´‹çµŒæ¸ˆ",url:"https://toyokeizai.net/"},
      {id:"0009",name:"CNN",url:"https://www.cnn.co.jp/"},
      {id:"0010",name:"GIGAZINE",url:"https://gigazine.net/"},   
    ],
    learnings:[
      {id:"1001",name:"Schoo",url:"https://schoo.jp/"},
      {id:"1002",name:"JMOOC",url:"https://www.jmooc.jp/"},
      {id:"1003",name:"Progate",url:"https://prog-8.com/dashboard"},
      {id:"1004",name:"Udemy",url:"https://www.udemy.com/"},
    ],
    drives:[
      {id:"2001",name:"Frames",url:"https://drive.google.com/drive/u/0/folders/1T8Fr9Q_svATBleRkEWiVN9GmO6s3zcsb"},
      {id:"2002",name:"MyDrive",url:"https://drive.google.com/drive/u/0/my-drive"},
      {id:"2003",name:"swordFishâ…¢",url:"https://drive.google.com/drive/u/0/folders/1JdY8rZA2e1sUW9wQ3oyHj6Jbx60aMxL8"},
      {id:"2004",name:"DropBox",url:"https://www.dropbox.com/home"},
    ],
    gsuites:[
      {id:"3001",name:"Gmail",url:"https://mail.google.com/mail/u/1/#inbox"},
      {id:"3002",name:"GooglePhoto",url:"https://photos.google.com/u/1/?referrer=GPU&pageId=none"},
      {id:"3003",name:"Google Calendar",url:"https://calendar.google.com/calendar/r?cid=ajJkcTlrNzJpY3VrbGMzaTI1aDhnYzFyMW9AZ3JvdXAuY2FsZW5kYXIuZ29vZ2xlLmNvbQ"},
      {id:"3004",name:"Google Keep",url:"https://keep.google.com/u/0/#home"},
    ],
    tools:[
      {id:"4001",name:"Chat-GPT",url:"https://chatgpt.com/"},
      {id:"4002",name:"Claude",url:"https://claude.ai/new"},
      {id:"4003",name:"Dify",url:"https://cloud.dify.ai/apps"},
      {id:"4004",name:"Trello",url:"https://trello.com/b/9J0Xza0u/%E6%9D%89%E6%A3%AE%E3%81%AE%E3%83%9C%E3%83%BC%E3%83%89"},
      {id:"4005",name:"AppSheet",url:"https://www.appsheet.com/Template/Apps "},
      {id:"4006",name:"Canva",url:"https://www.canva.com/ja_jp/"},
      {id:"4007",name:"draw.io",url:"https://www.draw.io/"},
      {id:"4008",name:"NetPrint",url:"https://networkprint.ne.jp/sharp_netprint/ja/mypage.aspx"},
      {id:"4009",name:"icooon-mono",url:"https://icooon-mono.com/"},
    ],
    its:[
      {id:"5001",name:"Github",url:"https://github.com/"},
      {id:"5002",name:"Qiita",url:"https://qiita.com/"},
      {id:"5003",name:"GoogleAppsScript",url:"https://developers.google.com/apps-script/reference"},
      {id:"5004",name:"Vue.js",url:"https://012-jp.vuejs.org/guide/"},
      {id:"5005",name:"Bootstrap",url:"https://getbootstrap.jp/docs/4.2/getting-started/introduction/"},
    ],
    tvs:[
      {id:"6001",name:"Abemaãƒ‹ãƒ¥ãƒ¼ã‚¹",url:"https://abema.tv/now-on-air/abema-news"},
      {id:"6002",name:"Netflix",url:"https://www.netflix.com/browse/my-list"},
      {id:"6003",name:"AmazonPrime",url:"https://www.amazon.co.jp/gp/video/mystuff/ref=atv_nb_mystuff"},
      {id:"6004",name:"U-Next",url:"https://video.unext.jp/"},
      {id:"6005",name:"Disney+",url:"https://www.disneyplus.com/ja-jp/home"},
      {id:"6006",name:"NHKã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰",url:"https://www.nhk-ondemand.jp/#/0/"},
      {id:"6007",name:"Youtubeãƒ©ã‚¤ãƒ–ãƒ©ãƒª",url:"https://www.youtube.com/feed/library"},
      {id:"6008",name:"YoutubeãƒŸãƒ¥ãƒ¼ã‚¸ãƒƒã‚¯",url:"https://music.youtube.com/"},
      {id:"6009",name:"ãƒ‹ã‚³ãƒ‹ã‚³å‹•ç”»",url:"https://www.nicovideo.jp/my/mylist?cmnhd_ref=device%3Dpc%26site%3Dniconico%26pos%3Duserpanel%26page%3Dtop"},
      {id:"6010",name:"Pixiv",url:"https://www.pixiv.net/"},
    ],
    prvs:[
      {id:"7001",name:"Twitter",url:"https://twitter.com/home"},
      {id:"7002",name:"ä¸ƒå°¾ãˆã¿ Channel",url:"https://www.youtube.com/channel/UCNpaS7EteiT1IFigRBfW6eg"},
      {id:"7003",name:"Mirrativé…ä¿¡ç”»é¢",url:"https://www.mirrativ.com/"},
      {id:"7004",name:"ã¯ã¦ãªãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯",url:"https://b.hatena.ne.jp/hantenasgmr/bookmark"},
      {id:"7005",name:"Facebook",url:"https://www.facebook.com/"},
      {id:"7006",name:"æ¥½å¤©éŠ€è¡Œ",url:"https://fes.rakuten-bank.co.jp/MS/main/RbS?CurrentPageID=START&&COMMAND=LOGIN"},
      {id:"7007",name:"ä¸ƒå°¾ãˆã¿FRX",url:"https://hub.vroid.com/characters/679022379978810834/models/522769586827415511"},
    ],
    showContents:["99999"],
    showNav: true,
    iframeError: false,
    alreadyOpened: false,
    errorDetails: null
  },
  watch: {
    showNav(newVal) {
      const iframe = this.$refs.fullscreenFrame;
      if (iframe) {
        iframe.style.pointerEvents = newVal ? 'none' : 'auto';
      }
    }
  },
  mounted() {
    window.addEventListener('mousemove', this.handleMouseMove);
  },
  beforeDestroy() {
    window.removeEventListener('mousemove', this.handleMouseMove);
  },
  methods:{
    handleMouseMove(e) {
      const y = e.clientY;
      this.showNav = (y < 30); // ãƒ›ãƒãƒ¼ã‚¾ãƒ¼ãƒ³ã®é«˜ã•ã«åˆã‚ã›ã‚‹
    },
    toggle: function(data) {
      this.showContents = [data];
      this.alreadyOpened = false;
      this.iframeError = false; // ã‚¨ãƒ©ãƒ¼çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ
      this.errorDetails = null;
    },
    handleIframeLoad() {
      // AppSheeté–¢é€£ã®å ´åˆ
      if (this.showContents[0] === '99999') {
        // å°‘ã—é…å»¶ã•ã›ã¦åˆå›ãƒã‚§ãƒƒã‚¯
        setTimeout(() => {
          this.checkForAppSheetErrors();
        }, 300);

        // ä¸€å®šæ™‚é–“å¾Œã«ã‚‚å†ãƒã‚§ãƒƒã‚¯ï¼ˆé…å»¶èª­ã¿è¾¼ã¿ã«å¯¾å¿œï¼‰
        setTimeout(() => {
          this.checkForAppSheetErrors();
        }, 1500);
      }
    },
    
    // AppSheetã‚¨ãƒ©ãƒ¼ãƒã‚§ãƒƒã‚¯ã‚’åˆ†é›¢ã—ãŸé–¢æ•°
    checkForAppSheetErrors() {
      try {
        const iframe = this.$refs.fullscreenFrame;
        if (!iframe) return;
        
        // 1. ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹ã‚’è©¦ã¿ã‚‹
        let iframeDoc;
        try {
          iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
        } catch (e) {
          // ã‚¯ãƒ­ã‚¹ã‚ªãƒªã‚¸ãƒ³ã‚¨ãƒ©ãƒ¼ãªã‚‰ã°ã‚¨ãƒ©ãƒ¼ãƒ•ãƒ©ã‚°ã‚’ç«‹ã¦ã‚‹
          this.iframeError = true;
          console.warn("ã‚¯ãƒ­ã‚¹ã‚ªãƒªã‚¸ãƒ³ãƒãƒªã‚·ãƒ¼ã«ã‚ˆã‚Šiframeã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ãŒã§ãã¾ã›ã‚“", e);
          return;
        }
        
        if (!iframeDoc) return;
        
        // 2. iframeå†…ã®è¦ç´ ã‹ã‚‰çŠ¶æ…‹ã‚’ç¢ºèª
        const text = iframeDoc.body.innerText || '';
        
        // 3. ã‚¨ãƒ©ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ‹¡å¼µ
        const errorPatterns = [
          "requestStorageAccess",
          "Error obtaining storage access",
          "æ¥ç¶šãŒæ‹’å¦ã•ã‚Œã¾ã—ãŸ",
          "Sign into AppSheet",
          "Why am I seeing this?",
          "denied",
          "access",
          "æ‹’å¦",
          "æ¥ç¶š",
          "error",
          "refused",
          "connection",
          "blocked",
          "ãƒ–ãƒ­ãƒƒã‚¯"
        ];
        
        const hasError = errorPatterns.some(pattern => 
          text.toLowerCase().includes(pattern.toLowerCase()));
        
        // 4. è¦‹ãŸç›®ã®ãƒã‚§ãƒƒã‚¯ã‚‚è¿½åŠ 
        const hasErrorIcon = iframeDoc.querySelector('.error-icon') || 
                            iframeDoc.querySelector('[data-error]') ||
                            iframeDoc.body.innerHTML.includes('face_with_raised_eyebrow');
        
        if ((hasError || hasErrorIcon) && !this.alreadyOpened) {
          this.iframeError = true;
          this.errorDetails = {
            type: 'connection_refused',
            message: 'AppSheetã¨ã®æ¥ç¶šãŒæ‹’å¦ã•ã‚Œã¾ã—ãŸã€‚æ–°ã—ã„ã‚¿ãƒ–ã§ç›´æ¥é–‹ã„ã¦ãã ã•ã„ã€‚'
          };
        }
      } catch (e) {
        // ã™ã¹ã¦ã®ä¾‹å¤–ã‚’ã‚­ãƒ£ãƒƒãƒ
        this.iframeError = true;
        console.warn("AppSheetã®èª­ã¿è¾¼ã¿ã«å•é¡ŒãŒç™ºç”Ÿã—ã¾ã—ãŸ", e);
      }
    },
    
    // ã‚¨ãƒ©ãƒ¼çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆã™ã‚‹é–¢æ•°
    resetAppSheetError() {
      this.iframeError = false;
      this.errorDetails = null;
    },
    
    // æ˜ç¤ºçš„ã«æ–°ã—ã„ã‚¿ãƒ–ã§é–‹ãæ©Ÿèƒ½
    openAppsheetInNewTab() {
      const appsheetUrl = "https://www.appsheet.com/start/b3cc011c-f2d9-4021-b16f-2efdd921a42b";
      window.open(appsheetUrl, '_blank');
      this.alreadyOpened = true;
    },
    
    // AppSheetã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿèƒ½ï¼ˆãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç”¨ï¼‰
    openAppsheetFallback() {
      const appsheetUrl = "https://www.appsheet.com/start/b3cc011c-f2d9-4021-b16f-2efdd921a42b";
      window.open(appsheetUrl, '_blank');
      this.alreadyOpened = true;
    },
    
    // å•é¡Œè§£æ±ºã®ãŸã‚ã®ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚¹ãƒ†ãƒƒãƒ—
    troubleshootAppSheet() {
      const steps = [
        "1. ãƒ–ãƒ©ã‚¦ã‚¶ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¨Cookieã‚’ã‚¯ãƒªã‚¢ã—ã¾ã™",
        "2. åˆ¥ã®ãƒ–ãƒ©ã‚¦ã‚¶ã§è©¦ã—ã¦ã¿ã¾ã™",
        "3. ä¼æ¥­ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã§ã¯ãªãã€å€‹äººã®å›ç·šã§è©¦ã—ã¦ã¿ã¾ã™",
        "4. Google ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«ç›´æ¥ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã‹ã‚‰å†è©¦è¡Œã—ã¾ã™",
        "5. AppSheetã«ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã‹ã‚‰ãƒãƒ¼ã‚¿ãƒ«ã«æˆ»ã‚Šã¾ã™"
      ];
      
      alert(steps.join("\n"));
    }
  },
});
</script>
</html>
