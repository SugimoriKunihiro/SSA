<!DOCTYPE html>
<html>
  <head>
    <title>ARIEL</title>
    <base target="_top">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css"    
      integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" 
      integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" 
      integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" 
      integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
    <!-- Google API ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ã‚ˆã‚Šæ˜ç¤ºçš„ã«èª­ã¿è¾¼ã‚€ -->
    <script src="https://apis.google.com/js/platform.js"></script>
    <!-- Google ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆIDã®æ­£ã—ã„è¨­å®š -->
    <meta name="google-signin-client_id" content="50428583319-gicuh9uve4gcj36a5huuhm5m0jcb3fr4.apps.googleusercontent.com">
    <meta name="google-signin-scope" content="email profile">
    <meta name="google-signin-cookiepolicy" content="single_host_origin">

    <style>
      /* å…±é€šã‚¹ã‚¿ã‚¤ãƒ« */
      html, body {
        margin: 0;
        height: 100%;
        overflow: hidden;
        background-color: #343a40;
        color: white;
      }

      /* ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã‚¹ã‚¿ã‚¤ãƒ« */
      #app {
        height: 100%;
        overflow: hidden;
        display: none; /* æœ€åˆã¯éè¡¨ç¤º */
      }

      .fullscreen-appsheet {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        z-index: 1;
      }

      .fullscreen-appsheet iframe {
        width: 100%;
        height: 100%;
        border: none;
      }
      
      /* AppSheetãƒ˜ãƒ«ãƒ‘ãƒ¼ã®ã‚¹ã‚¿ã‚¤ãƒ« */
      .appsheet-helper {
        opacity: 0.95;
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        transition: opacity 0.3s ease;
      }
      
      .appsheet-helper:hover {
        opacity: 1;
      }

      #nav-hover-zone {
        position: fixed;
        top: 0;
        left: 0;
        height: 30px;
        width: 100vw;
        background: transparent;
        z-index: 100;
        pointer-events: auto;
      }

      #nav-hover-bar {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 40px;
        background-color: #343a40;
        color: white;
        z-index: 101;
        transform: translateY(-100%);
        transition: transform 0.4s ease-in-out;
        pointer-events: auto;
      }

      #nav-hover-bar.active {
        transform: translateY(0%);
      }

      /* èªè¨¼é–¢é€£ã®ã‚¹ã‚¿ã‚¤ãƒ« */
      #auth-page {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        height: 100vh;
        width: 100vw;
        background-color: #343a40;
      }

      .auth-container {
        background-color: rgba(255, 255, 255, 0.1);
        border-radius: 8px;
        padding: 30px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        max-width: 400px;
        width: 100%;
        text-align: center;
      }

      .title {
        margin-bottom: 30px;
        font-size: 2rem;
      }

      .login-methods {
        display: flex;
        flex-direction: column;
        gap: 20px;
      }

      .custom-signin-button {
        background-color: white;
        color: #444;
        border-radius: 5px;
        border: none;
        padding: 10px 15px;
        font-weight: bold;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: background-color 0.3s;
      }

      .custom-signin-button:hover {
        background-color: #f1f1f1;
      }

      .custom-signin-button img {
        margin-right: 10px;
        width: 18px;
        height: 18px;
      }

      #errorMessage {
        color: #ff6b6b;
        margin-top: 15px;
        display: none;
      }

      .hidden {
        display: none;
      }

      .user-auth-status {
        position: fixed;
        top: 10px;
        right: 15px;
        z-index: 102;
        display: flex;
        align-items: center;
        color: white;
        font-size: 0.8rem;
      }
      
      .user-email {
        margin-right: 10px;
        max-width: 200px;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }
      
      .logout-btn {
        background-color: rgba(255, 255, 255, 0.2);
        color: white;
        border: none;
        padding: 3px 8px;
        border-radius: 4px;
        font-size: 0.75rem;
        cursor: pointer;
        transition: background-color 0.2s;
      }
      
      .logout-btn:hover {
        background-color: rgba(255, 255, 255, 0.3);
      }

      #loading-view {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
      }
      
      .emergency-access {
        margin-top: 20px;
        padding-top: 20px;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
      }
      
      .status-message {
        margin-top: 15px;
        padding: 8px;
        border-radius: 4px;
        background-color: rgba(0, 0, 0, 0.2);
        font-size: 0.9rem;
      }
      
      .debug-section {
        margin-top: 20px;
        padding: 10px;
        background-color: rgba(0, 0, 0, 0.3);
        border-radius: 4px;
        text-align: left;
        font-family: monospace;
        font-size: 0.8rem;
      }
    </style>
  </head>

  <body>
    <!-- èªè¨¼ãƒšãƒ¼ã‚¸ -->
    <div id="auth-page">
      <div class="auth-container">
        <h1 class="title">ARIEL ãƒãƒ¼ã‚¿ãƒ«</h1>
        
        <div id="login-view">
          <p>ç¶šè¡Œã™ã‚‹ã«ã¯èªè¨¼ãŒå¿…è¦ã§ã™</p>
          
          <div class="login-methods">
            <!-- ã‚·ãƒ³ãƒ—ãƒ«ãªã‚«ã‚¹ã‚¿ãƒ ãƒ‡ã‚¶ã‚¤ãƒ³ã®ãƒœã‚¿ãƒ³ -->
            <button onclick="directSignIn()" class="custom-signin-button mt-3">
              <img src="https://upload.wikimedia.org/wikipedia/commons/5/53/Google_%22G%22_Logo.svg" alt="Google logo">
              Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ­ã‚°ã‚¤ãƒ³
            </button>
            
            <!-- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ -->
            <div id="statusMessage" class="status-message" style="display: none;">
              èªè¨¼çŠ¶æ…‹ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ã„ã¾ã™...
            </div>
            
            <!-- ç·Šæ€¥ã‚¢ã‚¯ã‚»ã‚¹æ©Ÿèƒ½ -->
            <div class="emergency-access">
              <p class="small">èªè¨¼ã«å•é¡ŒãŒç™ºç”Ÿã—ãŸå ´åˆ:</p>
              <button onclick="emergencyAccess()" class="btn btn-sm btn-danger">
                ç·Šæ€¥ã‚¢ã‚¯ã‚»ã‚¹ (ç®¡ç†è€…ç”¨)
              </button>
            </div>
            
            <!-- ãƒ‡ãƒãƒƒã‚°æƒ…å ± -->
            <div id="debugInfo" class="debug-section" style="display: none;">
              <div>èªè¨¼ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: <span id="authStatus">æœªåˆæœŸåŒ–</span></div>
              <div>æœ€çµ‚ã‚¨ãƒ©ãƒ¼: <span id="lastError">ãªã—</span></div>
              <div>ã‚¢ã‚¯ã‚·ãƒ§ãƒ³: <span id="lastAction">ãªã—</span></div>
            </div>
          </div>
          
          <div id="errorMessage"></div>
        </div>
        
        <div id="loading-view" class="hidden">
          <div class="d-flex justify-content-center">
            <div class="spinner-border text-light" role="status">
              <span class="sr-only">Loading...</span>
            </div>
          </div>
          <p class="mt-3">èªè¨¼ä¸­...</p>
        </div>
      </div>
    </div>

    <!-- ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ -->
    <div class="user-auth-status" id="user-auth-status" style="display: none;">
      <span class="user-email" id="user-email"></span>
      <button class="logout-btn" onclick="logout()">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</button>
    </div>

    <!-- ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒª -->
    <div id="app"><!--appã“ã“ã‹ã‚‰-->
      <!-- iframeå…¨ç”»é¢ -->
      <div class="fullscreen-appsheet" id="appsheet-container-99999">
        <iframe
          src="https://www.appsheet.com/start/b3cc011c-f2d9-4021-b16f-2efdd921a42b"
          id="fullscreenFrame"
          style="width: 100%; height: 100%; border: none;"
          scrolling="no"
          allowfullscreen
          allow="clipboard-read; clipboard-write;">
        </iframe>
        
        <!-- AppSheetå°‚ç”¨ã®ãƒ˜ãƒ«ãƒ—ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ -->
        <div id="appsheet-helper" class="appsheet-helper alert alert-info m-3 position-absolute" 
             style="top: 0; left: 0; right: 0; max-width: 600px; margin: 0 auto; z-index: 10;">
          <button type="button" class="close" onclick="document.getElementById('appsheet-helper').style.display='none'">&times;</button>
          <h5>AppSheetã‚¢ãƒ—ãƒªã«ã¤ã„ã¦</h5>
          <p>è¡¨ç¤ºã«å•é¡ŒãŒã‚ã‚‹å ´åˆã¯ã€ä¸‹è¨˜ã®ã€Œæ–°ã—ã„ã‚¿ãƒ–ã§é–‹ãã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚ã¾ãŸã¯X-frame headerã‚’ç„¡åŠ¹åŒ–ã™ã‚‹ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã«å°å…¥ã—ã¦ãã ã•ã„</p>
          <button onclick="openAppsheetInNewTab()" class="btn btn-primary btn-sm">
            æ–°ã—ã„ã‚¿ãƒ–ã§é–‹ã
          </button>
        </div>
      </div>

      <!-- ã‚¨ãƒ©ãƒ¼æ™‚ã®å¼·åŒ–ã•ã‚ŒãŸAppSheetãƒªã‚«ãƒãƒªãƒ¼UI -->
      <div id="iframe-error" style="display: none;" class="d-flex flex-column align-items-center my-4 p-3 bg-light rounded">
        <div class="alert alert-danger mb-3 w-100" role="alert">
          <h4 class="alert-heading">
            <span class="mr-2">âš ï¸</span> 
            AppSheetã‚¢ãƒ—ãƒªã®è¡¨ç¤ºã«å•é¡ŒãŒç™ºç”Ÿã—ã¦ã„ã¾ã™
          </h4>
          <p>ã‚µãƒ¼ãƒãƒ¼ã¸ã®æ¥ç¶šãŒæ‹’å¦ã•ã‚Œã¾ã—ãŸã€‚ã“ã‚Œã«ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªåŸå› ãŒè€ƒãˆã‚‰ã‚Œã¾ã™ï¼š</p>
          <ul>
            <li>ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šã®å•é¡Œï¼ˆä¼æ¥­ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®åˆ¶é™ãªã©ï¼‰</li>
            <li>AppSheetã‚µãƒ¼ãƒ“ã‚¹ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã®å•é¡Œ</li>
            <li>ãƒ–ãƒ©ã‚¦ã‚¶ã®èªè¨¼æƒ…å ±ã‚„Cookieã®å•é¡Œ</li>
          </ul>
        </div>
        
        <div class="d-flex flex-column flex-md-row mb-3 w-100 justify-content-center">
          <button onclick="openAppsheetFallback()" class="btn btn-primary btn-lg m-2">
            <span class="mr-2">ğŸ”—</span> 
            AppSheetã‚’æ–°ã—ã„ã‚¿ãƒ–ã§é–‹ã
          </button>
          
          <button onclick="troubleshootAppSheet()" class="btn btn-outline-secondary btn-lg m-2">
            <span class="mr-2">ğŸ”§</span>
            ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
          </button>
        </div>
        
        <small class="text-muted mb-2">â€» ãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ãƒ–ãƒ­ãƒƒã‚¯ã‚’è¨±å¯ã—ã¦ãã ã•ã„</small>
        
        <div class="card w-100 mt-3">
          <div class="card-header bg-info text-white">
            ã•ã‚‰ã«è©³ã—ã„è§£æ±ºæ–¹æ³•
          </div>
          <div class="card-body">
            <ol>
              <li>Google ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«ç›´æ¥ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„</li>
              <li>ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆãƒ¢ãƒ¼ãƒ‰ã‚„åˆ¥ã®ãƒ–ãƒ©ã‚¦ã‚¶ã§è©¦ã—ã¦ã¿ã¦ãã ã•ã„</li>
              <li>ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¨Cookieã‚’ã‚¯ãƒªã‚¢ã—ã¦ã‹ã‚‰å†è©¦è¡Œã—ã¦ãã ã•ã„</li>
              <li>ä¼æ¥­ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å ´åˆã¯ã€å€‹äººå›ç·šã§è©¦ã—ã¦ã¿ã¦ãã ã•ã„</li>
              <li>ç›´æ¥ <a href="https://www.appsheet.com" target="_blank">AppSheet</a> ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ãƒ­ã‚°ã‚¤ãƒ³ã—ãŸå¾Œã€ã“ã®ãƒãƒ¼ã‚¿ãƒ«ã«æˆ»ã£ã¦ãã¦ãã ã•ã„</li>
            </ol>
          </div>
        </div>
        
        <button onclick="resetAppSheetError()" class="btn btn-link mt-3">
          ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºã‚’é–‰ã˜ã‚‹
        </button>
      </div>

      <!-- ãƒ›ãƒãƒ¼ã‚¾ãƒ¼ãƒ³ã¨ãƒŠãƒ“ -->
      <div id="nav-hover-zone" onmouseenter="setNavVisibility(true)" onmouseleave="setNavVisibility(false)"></div>
      <nav 
        id="nav-hover-bar"
        class="navbar navbar-expand-lg navbar-dark bg-secondary px-3"
        onmouseenter="setNavVisibility(true)"
        onmouseleave="setNavVisibility(false)">
        <h3 class="navbar-brand" onclick="toggleContent('99999')">ARIEL</h3>
          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown"
            aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
        
        <!--ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ãƒªã‚¹ãƒˆã“ã“ã‹ã‚‰-->
        <div class="collapse navbar-collapse" id="navbarNavDropdown">
          <ul class="navbar-nav">
   
           <!--ã‚«ãƒ†ã‚´ãƒªæ¯ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³(ãƒªãƒ³ã‚¯)ã“ã“ã‹ã‚‰-->
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" role="button" data-toggle="dropdown">Knowledge</a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink" id="knowledge-menu">
                <!-- ã‚«ã‚¹ã‚¿ãƒ ãƒ‡ãƒ¼ã‚¿ã¯JavaScriptã‹ã‚‰æ³¨å…¥ã•ã‚Œã¾ã™ -->
              </div>
            </li>
            <!--ã‚«ãƒ†ã‚´ãƒªæ¯ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³(ãƒªãƒ³ã‚¯)ã“ã“ã¾ã§-->
            
            <!--ã‚«ãƒ†ã‚´ãƒªæ¯ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³(ãƒªãƒ³ã‚¯)ã“ã“ã‹ã‚‰-->
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" role="button" data-toggle="dropdown">Learning</a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink" id="learning-menu">
                <!-- ã‚«ã‚¹ã‚¿ãƒ ãƒ‡ãƒ¼ã‚¿ã¯JavaScriptã‹ã‚‰æ³¨å…¥ã•ã‚Œã¾ã™ -->
              </div>
            </li>
            <!--ã‚«ãƒ†ã‚´ãƒªæ¯ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³(ãƒªãƒ³ã‚¯)ã“ã“ã¾ã§-->
        
            <!--ã‚«ãƒ†ã‚´ãƒªæ¯ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³(ãƒªãƒ³ã‚¯)ã“ã“ã‹ã‚‰-->
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" role="button" data-toggle="dropdown">Drive</a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink" id="drive-menu">
                <!-- ã‚«ã‚¹ã‚¿ãƒ ãƒ‡ãƒ¼ã‚¿ã¯JavaScriptã‹ã‚‰æ³¨å…¥ã•ã‚Œã¾ã™ -->
              </div>
            </li>
            <!--ã‚«ãƒ†ã‚´ãƒªæ¯ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³(ãƒªãƒ³ã‚¯)ã“ã“ã¾ã§-->

            <!--ã‚«ãƒ†ã‚´ãƒªæ¯ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³(ãƒªãƒ³ã‚¯)ã“ã“ã‹ã‚‰-->
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" role="button" data-toggle="dropdown">Google</a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink" id="gsuite-menu">
                <!-- ã‚«ã‚¹ã‚¿ãƒ ãƒ‡ãƒ¼ã‚¿ã¯JavaScriptã‹ã‚‰æ³¨å…¥ã•ã‚Œã¾ã™ -->
              </div>
            </li>
            <!--ã‚«ãƒ†ã‚´ãƒªæ¯ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³(ãƒªãƒ³ã‚¯)ã“ã“ã¾ã§-->

            <!--ã‚«ãƒ†ã‚´ãƒªæ¯ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³(ãƒªãƒ³ã‚¯)ã“ã“ã‹ã‚‰-->
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" role="button" data-toggle="dropdown">App</a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink" id="tool-menu">
                <!-- ã‚«ã‚¹ã‚¿ãƒ ãƒ‡ãƒ¼ã‚¿ã¯JavaScriptã‹ã‚‰æ³¨å…¥ã•ã‚Œã¾ã™ -->
              </div>
            </li>
            <!--ã‚«ãƒ†ã‚´ãƒªæ¯ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³(ãƒªãƒ³ã‚¯)ã“ã“ã¾ã§-->

            <!--ã‚«ãƒ†ã‚´ãƒªæ¯ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³(ãƒªãƒ³ã‚¯)ã“ã“ã‹ã‚‰-->
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" role="button" data-toggle="dropdown">IT</a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink" id="it-menu">
                <!-- ã‚«ã‚¹ã‚¿ãƒ ãƒ‡ãƒ¼ã‚¿ã¯JavaScriptã‹ã‚‰æ³¨å…¥ã•ã‚Œã¾ã™ -->
              </div>
            </li>
            <!--ã‚«ãƒ†ã‚´ãƒªæ¯ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³(ãƒªãƒ³ã‚¯)ã“ã“ã¾ã§-->

            <!--ã‚«ãƒ†ã‚´ãƒªæ¯ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³(ãƒªãƒ³ã‚¯)ã“ã“ã‹ã‚‰-->
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" role="button" data-toggle="dropdown">Media</a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink" id="tv-menu">
                <!-- ã‚«ã‚¹ã‚¿ãƒ ãƒ‡ãƒ¼ã‚¿ã¯JavaScriptã‹ã‚‰æ³¨å…¥ã•ã‚Œã¾ã™ -->
              </div>
            </li>
            <!--ã‚«ãƒ†ã‚´ãƒªæ¯ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³(ãƒªãƒ³ã‚¯)ã“ã“ã¾ã§-->

            <!--ã‚«ãƒ†ã‚´ãƒªæ¯ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³(ãƒªãƒ³ã‚¯)ã“ã“ã‹ã‚‰-->
             <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" role="button" data-toggle="dropdown">SNS/Private</a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink" id="prv-menu">
                <!-- ã‚«ã‚¹ã‚¿ãƒ ãƒ‡ãƒ¼ã‚¿ã¯JavaScriptã‹ã‚‰æ³¨å…¥ã•ã‚Œã¾ã™ -->
              </div>
            </li>
            <!--ã‚«ãƒ†ã‚´ãƒªæ¯ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³(ãƒªãƒ³ã‚¯)ã“ã“ã¾ã§-->
          </ul>
        </div>
        <!--ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ãƒªã‚¹ãƒˆã“ã“ã¾ã§-->
      </nav>
      <!--ãƒŠãƒ“ãƒãƒ¼ã“ã“ã¾ã§-->
      </br>
       
       <!--ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã«å¯¾ã™ã‚‹ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã“ã“ã‹ã‚‰-->
        <div id="sub">
          <!-- ç©ºã®ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³å¯¾å¿œé ˜åŸŸ -->
        </div>
        <!--ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã«å¯¾ã™ã‚‹ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã“ã“ã¾ã§-->
      
    </div>
    <!--appã“ã“ã¾ã§-->

    <script>
      // =====================
      // ãƒ‡ãƒ¼ã‚¿å®šç¾©
      // =====================
      // è¨±å¯ã™ã‚‹Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹
      const allowedEmails = [
        'k.sugimori.cz@gmail.com',
        'k.sugimori.p@gmail.com',
        'sugimori@skyarch.net'
        // å¿…è¦ã«å¿œã˜ã¦è¿½åŠ 
      ];
      
      // ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒ‡ãƒ¼ã‚¿
      const menuData = {
        knowledges: [
          {id:"0001",name:"Chat-GPT",url:"https://chatgpt.com/"},
          {id:"0002",name:"Flier",url:"https://www.flierinc.com/"},
          {id:"0003",name:"Googleãƒ‹ãƒ¥ãƒ¼ã‚¹",url:"https://news.google.com/"},
          {id:"0004",name:"çµŒæ¸ˆãƒ¬ãƒãƒ¼ãƒˆ",url:"http://www3.keizaireport.com/"},
          {id:"0005",name:"æœæ—¥æ–°è",url:"https://www.asahi.com/?iref=pc_gnavi"},
          {id:"0006",name:"NHKãƒ‹ãƒ¥ãƒ¼ã‚¹",url:"https://www3.nhk.or.jp/news/"},
          {id:"0007",name:"ãƒãƒ•ãƒã‚¹",url:"https://www.huffingtonpost.jp/"},
          {id:"0008",name:"æ±æ´‹çµŒæ¸ˆ",url:"https://toyokeizai.net/"},
          {id:"0009",name:"CNN",url:"https://www.cnn.co.jp/"},
          {id:"0010",name:"GIGAZINE",url:"https://gigazine.net/"},   
        ],
        learnings: [
          {id:"1001",name:"Schoo",url:"https://schoo.jp/"},
          {id:"1002",name:"JMOOC",url:"https://www.jmooc.jp/"},
          {id:"1003",name:"Progate",url:"https://prog-8.com/dashboard"},
          {id:"1004",name:"Udemy",url:"https://www.udemy.com/"},
        ],
        drives: [
          {id:"2001",name:"Frames",url:"https://drive.google.com/drive/u/0/folders/1T8Fr9Q_svATBleRkEWiVN9GmO6s3zcsb"},
          {id:"2002",name:"MyDrive",url:"https://drive.google.com/drive/u/0/my-drive"},
          {id:"2003",name:"swordFishâ…¢",url:"https://drive.google.com/drive/u/0/folders/1JdY8rZA2e1sUW9wQ3oyHj6Jbx60aMxL8"},
          {id:"2004",name:"DropBox",url:"https://www.dropbox.com/home"},
        ],
        gsuites: [
          {id:"3001",name:"Gmail",url:"https://mail.google.com/mail/u/1/#inbox"},
          {id:"3002",name:"GooglePhoto",url:"https://photos.google.com/u/1/?referrer=GPU&pageId=none"},
          {id:"3003",name:"Google Calendar",url:"https://calendar.google.com/calendar/r?cid=ajJkcTlrNzJpY3VrbGMzaTI1aDhnYzFyMW9AZ3JvdXAuY2FsZW5kYXIuZ29vZ2xlLmNvbQ"},
          {id:"3004",name:"Google Keep",url:"https://keep.google.com/u/0/#home"},
        ],
        tools: [
          {id:"4001",name:"Chat-GPT",url:"https://chatgpt.com/"},
          {id:"4002",name:"Claude",url:"https://claude.ai/new"},
          {id:"4003",name:"Dify",url:"https://cloud.dify.ai/apps"},
          {id:"4004",name:"Trello",url:"https://trello.com/b/9J0Xza0u/%E6%9D%89%E6%A3%AE%E3%81%AE%E3%83%9C%E3%83%BC%E3%83%89"},
          {id:"4005",name:"AppSheet",url:"https://www.appsheet.com/Template/Apps "},
          {id:"4006",name:"Canva",url:"https://www.canva.com/ja_jp/"},
          {id:"4007",name:"draw.io",url:"https://www.draw.io/"},
          {id:"4008",name:"NetPrint",url:"https://networkprint.ne.jp/sharp_netprint/ja/mypage.aspx"},
          {id:"4009",name:"icooon-mono",url:"https://icooon-mono.com/"},
        ],
        its: [
          {id:"5001",name:"Github",url:"https://github.com/"},
          {id:"5002",name:"Qiita",url:"https://qiita.com/"},
          {id:"5003",name:"GoogleAppsScript",url:"https://developers.google.com/apps-script/reference"},
          {id:"5004",name:"Vue.js",url:"https://012-jp.vuejs.org/guide/"},
          {id:"5005",name:"Bootstrap",url:"https://getbootstrap.jp/docs/4.2/getting-started/introduction/"},
        ],
        tvs: [
          {id:"6001",name:"Abemaãƒ‹ãƒ¥ãƒ¼ã‚¹",url:"https://abema.tv/now-on-air/abema-news"},
          {id:"6002",name:"Netflix",url:"https://www.netflix.com/browse/my-list"},
          {id:"6003",name:"AmazonPrime",url:"https://www.amazon.co.jp/gp/video/mystuff/ref=atv_nb_mystuff"},
          {id:"6004",name:"U-Next",url:"https://video.unext.jp/"},
          {id:"6005",name:"Disney+",url:"https://www.disneyplus.com/ja-jp/home"},
          {id:"6006",name:"NHKã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰",url:"https://www.nhk-ondemand.jp/#/0/"},
          {id:"6007",name:"Youtubeãƒ©ã‚¤ãƒ–ãƒ©ãƒª",url:"https://www.youtube.com/feed/library"},
          {id:"6008",name:"YoutubeãƒŸãƒ¥ãƒ¼ã‚¸ãƒƒã‚¯",url:"https://music.youtube.com/"},
          {id:"6009",name:"ãƒ‹ã‚³ãƒ‹ã‚³å‹•ç”»",url:"https://www.nicovideo.jp/my/mylist?cmnhd_ref=device%3Dpc%26site%3Dniconico%26pos%3Duserpanel%26page%3Dtop"},
          {id:"6010",name:"Pixiv",url:"https://www.pixiv.net/"},
        ],
        prvs: [
          {id:"7001",name:"Twitter",url:"https://twitter.com/home"},
          {id:"7002",name:"ä¸ƒå°¾ãˆã¿ Channel",url:"https://www.youtube.com/channel/UCNpaS7EteiT1IFigRBfW6eg"},
          {id:"7003",name:"Mirrativé…ä¿¡ç”»é¢",url:"https://www.mirrativ.com/"},
          {id:"7004",name:"ã¯ã¦ãªãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯",url:"https://b.hatena.ne.jp/hantenasgmr/bookmark"},
          {id:"7005",name:"Facebook",url:"https://www.facebook.com/"},
          {id:"7006",name:"æ¥½å¤©éŠ€è¡Œ",url:"https://fes.rakuten-bank.co.jp/MS/main/RbS?CurrentPageID=START&&COMMAND=LOGIN"},
          {id:"7007",name:"ä¸ƒå°¾ãˆã¿FRX",url:"https://hub.vroid.com/characters/679022379978810834/models/522769586827415511"},
        ]
      };
      
      // =====================
      // èªè¨¼é–¢é€£ã®é–¢æ•°
      // =====================
      
      // ãƒ­ã‚°è¡¨ç¤ºã¨ãƒ‡ãƒãƒƒã‚°æƒ…å ±ã®æ›´æ–°ã‚’åˆã‚ã›ã¦è¡Œã†
      function logDebug(message, type, data) {
        // ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ãƒ­ã‚°å‡ºåŠ›
        if (type === 'error') {
          console.error(message, data || '');
        } else if (type === 'warn') {
          console.warn(message, data || '');
        } else {
          console.log(message, data || '');
        }
        
        // ãƒ‡ãƒãƒƒã‚°æƒ…å ±ã®æ›´æ–°
        if (type === 'status') {
          document.getElementById('authStatus').textContent = message;
        } else if (type === 'error') {
          document.getElementById('lastError').textContent = message;
        } else if (type === 'action') {
          document.getElementById('lastAction').textContent = message;
        }
        
        // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®æ›´æ–°
        const statusMsg = document.getElementById('statusMessage');
        if (statusMsg) {
          statusMsg.textContent = message;
          statusMsg.style.display = 'block';
        }
      }
      
      // ç›´æ¥èªè¨¼ã‚’è¡Œã†ï¼ˆç°¡ç•¥åŒ–ã•ã‚ŒãŸã‚¢ãƒ—ãƒ­ãƒ¼ãƒï¼‰
      function directSignIn() {
        logDebug('ç›´æ¥ã‚µã‚¤ãƒ³ã‚¤ãƒ³ãŒé–‹å§‹ã•ã‚Œã¾ã—ãŸ', 'action', 'directSignIn');
        showLoading();
        
        // ãƒ‡ãƒãƒƒã‚°æƒ…å ±ã‚’è¡¨ç¤º
        document.getElementById('debugInfo').style.display = 'block';
        
        try {
          // ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ç›´æ¥æŒ‡å®šã—ã¦Googleã®èªè¨¼ãƒšãƒ¼ã‚¸ã‚’é–‹ã
          const authUrl = 'https://accounts.google.com/o/oauth2/auth' + 
            '?client_id=50428583319-gicuh9uve4gcj36a5huuhm5m0jcb3fr4.apps.googleusercontent.com' +
            '&redirect_uri=' + encodeURIComponent(window.location.origin + window.location.pathname) +
            '&response_type=token' +
            '&scope=email%20profile%20openid';
          
          // æ–°ã—ã„ã‚¿ãƒ–ã§ã¯ãªãç¾åœ¨ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§èªè¨¼ãƒšãƒ¼ã‚¸ã‚’é–‹ã
          window.location.href = authUrl;
          
          logDebug('Googleèªè¨¼ãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆä¸­...', 'status');
        } catch (e) {
          logDebug('èªè¨¼ãƒšãƒ¼ã‚¸ã®ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã«å¤±æ•—: ' + e.message, 'error', e);
          showError('Googleèªè¨¼ã®é–‹å§‹ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + e.message);
          hideLoading();
        }
      }
      
      // ç·Šæ€¥ã‚¢ã‚¯ã‚»ã‚¹ - èªè¨¼ã‚’ãƒã‚¤ãƒ‘ã‚¹ã—ã¦AppSheetã«ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹
      function emergencyAccess() {
        logDebug('ç·Šæ€¥ã‚¢ã‚¯ã‚»ã‚¹ãŒå®Ÿè¡Œã•ã‚Œã¾ã—ãŸ', 'action', 'emergencyAccess');
        
        // AppSheetã‚’åˆ¥ã‚¿ãƒ–ã§é–‹ã
        window.open('https://www.appsheet.com/start/b3cc011c-f2d9-4021-b16f-2efdd921a42b', '_blank');
        
        // ä»®èªè¨¼æƒ…å ±ã‚’è¨­å®š
        localStorage.setItem('ariel_emergency_access', 'true');
        
        // ãƒãƒ¼ã‚¿ãƒ«ç”»é¢ã«é·ç§»
        showApp('ç·Šæ€¥ã‚¢ã‚¯ã‚»ã‚¹');
        
        // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ›´æ–°
        showStatus('ç·Šæ€¥ã‚¢ã‚¯ã‚»ã‚¹ãƒ¢ãƒ¼ãƒ‰ã§è¡¨ç¤ºã—ã¦ã„ã¾ã™ï¼ˆåˆ¶é™æ©Ÿèƒ½ï¼‰', 'warning');
      }
      
      // èªè¨¼ã‚¨ãƒ©ãƒ¼æ™‚ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º
      function showError(message) {
        const errorElement = document.getElementById('errorMessage');
        errorElement.textContent = message;
        errorElement.style.display = 'block';
        errorElement.style.color = '#ff6b6b';
        
        logDebug(message, 'error');
        hideLoading();
      }
      
      // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º
      function showStatus(message, type) {
        const statusElement = document.getElementById('statusMessage');
        if (statusElement) {
          statusElement.textContent = message;
          statusElement.style.display = 'block';
          
          // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¿ã‚¤ãƒ—ã«å¿œã˜ã¦è‰²ã‚’å¤‰æ›´
          if (type === 'success') {
            statusElement.style.backgroundColor = 'rgba(40, 167, 69, 0.2)';
          } else if (type === 'warning') {
            statusElement.style.backgroundColor = 'rgba(255, 193, 7, 0.2)';
          } else if (type === 'error') {
            statusElement.style.backgroundColor = 'rgba(220, 53, 69, 0.2)';
          } else {
            statusElement.style.backgroundColor = 'rgba(0, 0, 0, 0.2)';
          }
        }
        
        logDebug(message, 'status');
      }
      
      // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤ºã®åˆ‡ã‚Šæ›¿ãˆ
      function showLoading() {
        document.getElementById('login-view').classList.add('hidden');
        document.getElementById('loading-view').classList.remove('hidden');
      }
      
      function hideLoading() {
        document.getElementById('login-view').classList.remove('hidden');
        document.getElementById('loading-view').classList.add('hidden');
      }
      
      // ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã®è¡¨ç¤º - ã‚·ãƒ³ãƒ—ãƒ«åŒ–
      function showApp(userEmail) {
        logDebug('ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã®è¡¨ç¤ºãŒé–‹å§‹ã•ã‚Œã¾ã—ãŸ: ' + userEmail, 'action', 'showApp');
        
        // èªè¨¼ãƒšãƒ¼ã‚¸ã‚’éè¡¨ç¤º
        document.getElementById('auth-page').style.display = 'none';
        
        // ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã‚’è¡¨ç¤º
        document.getElementById('app').style.display = 'block';
        
        // ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±è¡¨ç¤º
        document.getElementById('user-email').textContent = userEmail;
        document.getElementById('user-auth-status').style.display = 'flex';
        
        // ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ã‚’åˆæœŸè¡¨ç¤º
        setNavVisibility(true);
        setTimeout(() => {
          setNavVisibility(false);
        }, 3000);
        
        // ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®åˆæœŸåŒ–
        initializeMenus();
        
        logDebug('ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã®è¡¨ç¤ºãŒå®Œäº†ã—ã¾ã—ãŸ', 'status');
      }
      
      // ãƒ­ã‚°ã‚¢ã‚¦ãƒˆé–¢æ•°
      function logout() {
        logDebug('ãƒ­ã‚°ã‚¢ã‚¦ãƒˆå‡¦ç†ãŒé–‹å§‹ã•ã‚Œã¾ã—ãŸ', 'action', 'logout');
        
        // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰èªè¨¼æƒ…å ±ã‚’å‰Šé™¤
        localStorage.removeItem('ariel_auth_token');
        localStorage.removeItem('ariel_email');
        localStorage.removeItem('ariel_emergency_access');
        
        // ãƒšãƒ¼ã‚¸ã‚’ãƒªãƒ­ãƒ¼ãƒ‰
        window.location.reload();
      }
      
      // URLã‹ã‚‰ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—ï¼ˆãƒãƒƒã‚·ãƒ¥ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼‰
      function getTokenFromUrl() {
        try {
          const hash = window.location.hash.substring(1);
          const params = new URLSearchParams(hash);
          return params.get('access_token');
        } catch (e) {
          logDebug('URLã‹ã‚‰ã®ãƒˆãƒ¼ã‚¯ãƒ³å–å¾—ã‚¨ãƒ©ãƒ¼: ' + e.message, 'error', e);
          return null;
        }
      }
      
      // =====================
      // UIé–¢é€£ã®é–¢æ•°
      // =====================
      
      // ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ã®è¡¨ç¤º/éè¡¨ç¤ºã‚’è¨­å®š
      function setNavVisibility(isVisible) {
        const navBar = document.getElementById('nav-hover-bar');
        if (navBar) {
          if (isVisible) {
            navBar.classList.add('active');
          } else {
            navBar.classList.remove('active');
          }
        }
      }
      
      // ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®åˆ‡ã‚Šæ›¿ãˆ
      function toggleContent(id) {
        logDebug('ã‚³ãƒ³ãƒ†ãƒ³ãƒ„åˆ‡ã‚Šæ›¿ãˆ: ' + id, 'action', 'toggleContent');
        
        // AppSheetã‚³ãƒ³ãƒ†ãƒŠã®è¡¨ç¤ºåˆ¶å¾¡
        const container = document.getElementById('appsheet-container-99999');
        if (container) {
          container.style.display = id === '99999' ? 'block' : 'none';
        }
        
        // ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºã‚’ãƒªã‚»ãƒƒãƒˆ
        resetAppSheetError();
      }
      
      // AppSheetã‚¨ãƒ©ãƒ¼ã®ãƒªã‚»ãƒƒãƒˆ
      function resetAppSheetError() {
        document.getElementById('iframe-error').style.display = 'none';
      }
      
      // AppSheetã‚’æ–°ã—ã„ã‚¿ãƒ–ã§é–‹ã
      function openAppsheetInNewTab() {
        const appsheetUrl = "https://www.appsheet.com/start/b3cc011c-f2d9-4021-b16f-2efdd921a42b";
        window.open(appsheetUrl, '_blank');
        
        // ãƒ˜ãƒ«ãƒ‘ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’éè¡¨ç¤º
        document.getElementById('appsheet-helper').style.display = 'none';
      }
      
      // AppSheetã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
      function openAppsheetFallback() {
        const appsheetUrl = "https://www.appsheet.com/start/b3cc011c-f2d9-4021-b16f-2efdd921a42b";
        window.open(appsheetUrl, '_blank');
      }
      
      // AppSheetã®ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
      function troubleshootAppSheet() {
        const steps = [
          "1. ãƒ–ãƒ©ã‚¦ã‚¶ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¨Cookieã‚’ã‚¯ãƒªã‚¢ã—ã¾ã™",
          "2. åˆ¥ã®ãƒ–ãƒ©ã‚¦ã‚¶ã§è©¦ã—ã¦ã¿ã¾ã™",
          "3. ä¼æ¥­ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã§ã¯ãªãã€å€‹äººã®å›ç·šã§è©¦ã—ã¦ã¿ã¾ã™",
          "4. Google ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«ç›´æ¥ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã‹ã‚‰ARIELãƒãƒ¼ã‚¿ãƒ«ã«æˆ»ã‚Šã¾ã™",
          "5. AppSheetã«ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã‹ã‚‰ARIELãƒãƒ¼ã‚¿ãƒ«ã«æˆ»ã‚Šã¾ã™"
        ];
        
        alert(steps.join("\n"));
      }
      
      // ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®åˆæœŸåŒ–
      function initializeMenus() {
        // ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒ‡ãƒ¼ã‚¿ã®è¨­å®š
        const menuTypes = {
          'knowledges': 'knowledge-menu',
          'learnings': 'learning-menu',
          'drives': 'drive-menu',
          'gsuites': 'gsuite-menu',
          'tools': 'tool-menu',
          'its': 'it-menu',
          'tvs': 'tv-menu',
          'prvs': 'prv-menu'
        };
        
        // å„ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’åˆæœŸåŒ–
        for (const [dataKey, menuId] of Object.entries(menuTypes)) {
          const menuElement = document.getElementById(menuId);
          if (menuElement && menuData[dataKey]) {
            // ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’ã‚¯ãƒªã‚¢
            menuElement.innerHTML = '';
            
            // ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›®ã‚’è¿½åŠ 
            menuData[dataKey].forEach(item => {
              const link = document.createElement('a');
              link.className = 'dropdown-item';
              link.href = item.url;
              link.target = '_blank';
              link.textContent = item.name;
              menuElement.appendChild(link);
            });
          }
        }
      }
      
      // =====================
      // åˆæœŸåŒ–å‡¦ç†
      // =====================
      
      // ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰æ™‚ã®å‡¦ç†
      document.addEventListener('DOMContentLoaded', function() {
        logDebug('ãƒšãƒ¼ã‚¸ãŒèª­ã¿è¾¼ã¾ã‚Œã¾ã—ãŸ', 'status');
        
        // URLã®ãƒãƒƒã‚·ãƒ¥ã‚’ãƒã‚§ãƒƒã‚¯ - OAuthèªè¨¼ã‹ã‚‰ã®æˆ»ã‚Š
        const token = getTokenFromUrl();
        if (token) {
          logDebug('URLã‹ã‚‰ãƒˆãƒ¼ã‚¯ãƒ³ã‚’æ¤œå‡ºã—ã¾ã—ãŸ', 'status');
          showStatus('èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³ã‚’æ¤œå‡ºã—ã¾ã—ãŸã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’å–å¾—ä¸­...', 'success');
          
          // ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜
          localStorage.setItem('ariel_auth_token', token);
          
          // ã‚·ãƒ³ãƒ—ãƒ«ã«ç®¡ç†è€…è¨±å¯ãƒªã‚¹ãƒˆã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ä½¿ç”¨
          const adminEmail = 'k.sugimori.cz@gmail.com';
          localStorage.setItem('ariel_email', adminEmail);
          
          // ãƒãƒƒã‚·ãƒ¥ã‚’å‰Šé™¤ï¼ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å‘ä¸Šã®ãŸã‚ï¼‰
          window.location.hash = '';
          
          // ã‚¢ãƒ—ãƒªã‚’è¡¨ç¤º
          showApp(adminEmail);
          return;
        }
        
        // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ç¢ºèª
        const authToken = localStorage.getItem('ariel_auth_token');
        const email = localStorage.getItem('ariel_email');
        const emergency = localStorage.getItem('ariel_emergency_access');
        
        if (emergency === 'true') {
          logDebug('ç·Šæ€¥ã‚¢ã‚¯ã‚»ã‚¹ãƒ¢ãƒ¼ãƒ‰ã‚’æ¤œå‡ºã—ã¾ã—ãŸ', 'status');
          showApp('ç·Šæ€¥ã‚¢ã‚¯ã‚»ã‚¹');
          return;
        }
        
        if (authToken && email && allowedEmails.includes(email)) {
          logDebug('ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«æœ‰åŠ¹ãªèªè¨¼æƒ…å ±ã‚’æ¤œå‡º: ' + email, 'status');
          showApp(email);
          return;
        }
        
        // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«æœ‰åŠ¹ãªæƒ…å ±ãŒãªã„å ´åˆã¯èªè¨¼ãƒšãƒ¼ã‚¸ã‚’è¡¨ç¤º
        showStatus('èªè¨¼ãŒå¿…è¦ã§ã™', 'info');
      });
